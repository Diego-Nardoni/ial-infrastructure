{
  "phase_number": 50,
  "phase_name": "storage",
  "yaml_content": "```yaml\nAWSTemplateFormatVersion: '2010-09-09'\nDescription: 'S3 bucket with encryption, logging, and lifecycle policies'\n\nParameters:\n  BucketName:\n    Type: String\n    Description: Name of the S3 bucket\n\nResources:\n\n  # S3 Bucket\n  S3Bucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      # Bucket Name\n      BucketName: !Ref BucketName\n      # Encryption at rest with KMS\n      BucketEncryption:\n        ServerSideEncryptionConfiguration:\n          - ServerSideEncryptionByDefault:\n              SSEAlgorithm: 'AES256'\n      # Enforce TLS in transit\n      BucketPolicy:\n        PolicyDocument:\n          Version: '2012-10-17'\n          Statement:\n            - Effect: Deny\n              Principal: '*'\n              Action: 's3:*'\n              Resource:\n                - !Sub \"arn:aws:s3:::${BucketName}/*\"\n                - !GetAtt S3Bucket.Arn\n              Condition:\n                Bool:\n                  'aws:SecureTransport': false\n      # Lifecycle policy for cost optimization\n      LifecycleConfiguration:\n        Rules:\n          - Id: DeleteOldObjects\n            Status: Enabled\n            Transitions:\n              - StorageClass: GLACIER\n                TransitionInDays: 30\n            ExpirationInDays: 365\n\n  # S3 Bucket Policy\n  S3BucketPolicy:\n    Type: AWS::S3::BucketPolicy\n    Properties:\n      Bucket: !Ref S3Bucket\n      PolicyDocument:\n        Version: '2012-10-17'\n        Statement:\n          # Allow S3 LogDelivery group to write access logs\n          - Sid: AllowLogWriting\n            Effect: Allow\n            Principal:\n              AWS: !GetAtt LogDeliveryGroup.Arn\n            Action: 's3:PutObject'\n            Resource: !Sub \"arn:aws:s3:::${BucketName}/logs/*\"\n\n  # IAM Group for S3 LogDelivery\n  LogDeliveryGroup:\n    Type: AWS::IAM::Group\n    Properties:\n      GroupName: S3LogDelivery\n      ManagedPolicyArns:\n        - !Ref 'AWS::NoValue'\n\n  # CloudWatch Logs\n  LogsBucket:\n    Type: AWS::Logs::LogGroup\n    Properties:\n      LogGroupName: !Sub \"/aws/s3/${BucketName}\"\n      RetentionInDays: 365\n\nOutputs:\n\n  S3BucketName:\n    Value: !Ref S3Bucket\n    Description: Name of the created S3 bucket\n    Export:\n      Name: !Sub \"${AWS::StackName}-S3BucketName\"\n\nMetadata:\n  AWS::CloudFormation::Interface:\n    ParameterGroups:\n      - Label:\n          default: Bucket Configuration\n        Parameters:\n          - BucketName\n\nTags:\n  ManagedBy: IAL\n  CreatedAt: 2025-12-01T14:48:09.335724\n```\n\nCe mod\u00e8le CloudFormation cr\u00e9e un compartiment S3 avec les fonctionnalit\u00e9s suivantes :\n\n- Chiffrement au repos avec KMS (AES256)\n- Chiffrement en transit avec TLS obligatoire\n- Une politique de compartiment accordant au groupe IAM LogDelivery l'autorisation d'\u00e9crire les journaux d'acc\u00e8s\n- Un groupe IAM LogDelivery pour les journaux d'acc\u00e8s\n- Un groupe de journaux CloudWatch pour les journaux d'acc\u00e8s S3, avec une p\u00e9riode de r\u00e9tention de 365 jours\n- Une politique de cycle de vie pour d\u00e9placer les objets vers Glacier apr\u00e8s 30 jours et les supprimer apr\u00e8s 365 jours\n- Sorties export\u00e9es pour le nom du compartiment\n- M\u00e9tadonn\u00e9es avec des groupes de param\u00e8tres\n- Balises ManagedBy et CreatedAt appliqu\u00e9es\n\nCe mod\u00e8le suit les bonnes pratiques AWS en mati\u00e8re de s\u00e9curit\u00e9, de haute disponibilit\u00e9, d'optimisation des co\u00fbts et d'observabilit\u00e9. Cependant, notez que ce mod\u00e8le ne cr\u00e9e pas de ressources multiples AZ ou avec Scale Auto Scaling car ce cas d'utilisation sp\u00e9cifique n'en a pas besoin.",
  "dependencies": [],
  "estimated_cost": 0.0,
  "created_at": "2025-12-01T14:48:26.519490"
}