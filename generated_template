{
  "phase_number": 50,
  "phase_name": "storage",
  "yaml_content": "```yaml\nAWSTemplateFormatVersion: '2010-09-09'\nDescription: >-\n  CloudFormation template para criar um bucket S3 seguro, altamente dispon\u00edvel\n  e otimizado para custos.\n\nParameters:\n  BucketName:\n    Type: String\n    Description: Nome do bucket S3 a ser criado.\n\nResources:\n\n  # Cria\u00e7\u00e3o do bucket S3\n  S3Bucket:\n    Type: 'AWS::S3::Bucket'\n    Properties:\n      BucketName: !Ref BucketName\n      PublicAccessBlockConfiguration:\n        BlockPublicAcls: true\n        BlockPublicPolicy: true\n        IgnorePublicAcls: true\n        RestrictPublicBuckets: true\n      BucketEncryption:\n        ServerSideEncryptionConfiguration:\n          - ServerSideEncryptionByDefault:\n              SSEAlgorithm: 'AES256'\n      LifecycleConfiguration:\n        Rules:\n          - Id: TransitionToInfrequentAccess\n            Status: Enabled\n            Transitions:\n              - StorageClass: 'GLACIER'\n                TransitionInDays: 90\n          - Id: ExpireObjectsAfterOneYear\n            Status: Enabled\n            ExpirationInDays: 365\n\n  # Pol\u00edtica de acesso restrita para o bucket\n  S3BucketPolicy:\n    Type: 'AWS::S3::BucketPolicy'\n    Properties:\n      Bucket: !Ref S3Bucket\n      PolicyDocument:\n        Version: '2012-10-17'\n        Statement:\n          - Sid: DenyUnEncryptedObjectUploads\n            Effect: Deny\n            Principal: '*'\n            Action: 's3:PutObject'\n            Resource: !Join \n              - ''\n              - - !GetAtt 'S3Bucket.Arn'\n                - '/*'\n            Condition:\n              Null:\n                's3:x-amz-server-side-encryption': 'true'\n          - Sid: DenyInsecureConnections\n            Effect: Deny\n            Principal: '*'\n            Action: 's3:*'\n            Resource: \n              - !GetAtt 'S3Bucket.Arn'\n              - !Join \n                - ''\n                - - !GetAtt 'S3Bucket.Arn' \n                  - '/*'\n            Condition:\n              Bool:\n                'aws:SecureTransport': 'false'\n\nOutputs:\n\n  S3BucketName:\n    Value: !Ref S3Bucket\n    Description: Nome do bucket S3 criado\n    Export:\n      Name: S3BucketName\n\nMetadata:\n  ManagedBy: IAL  \n  CreatedAt: '2025-12-01T15:04:44.124336'\n```",
  "dependencies": [],
  "estimated_cost": 0.0,
  "created_at": "2025-12-01T15:04:53.590171"
}