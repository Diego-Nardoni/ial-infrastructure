# GitHub MCP Server Configuration
name: github-mcp-server
version: "1.0"
description: "GitHub integration for IAL system"

# Server configuration
server:
  command: "npx"
  args: ["-y", "@modelcontextprotocol/server-github"]
  timeout: 30
  retry_attempts: 3
  
# Environment variables
environment:
  GITHUB_PERSONAL_ACCESS_TOKEN: "${GITHUB_TOKEN}"
  
# Capabilities
capabilities:
  repositories:
    - create_repository
    - search_repositories
    - fork_repository
    - get_repository_info
    
  issues:
    - create_issue
    - list_issues
    - update_issue
    - close_issue
    
  pull_requests:
    - create_pull_request
    - list_pull_requests
    - merge_pull_request
    - review_pull_request
    
  files:
    - get_file
    - create_or_update_file
    - push_files
    - delete_file
    
  search:
    - search_code
    - search_issues
    - search_repositories
    - search_users
    
  workflows:
    - list_workflows
    - trigger_workflow
    - get_workflow_runs

# Integration with IAL
ial_integration:
  # Triggers for automatic GitHub operations
  auto_triggers:
    - event: "infrastructure_change"
      action: "create_pull_request"
      template: "infrastructure_update"
      
    - event: "drift_detected"
      action: "create_issue"
      template: "drift_alert"
      
    - event: "deployment_complete"
      action: "update_issue"
      template: "deployment_status"

  # Templates for GitHub operations
  templates:
    infrastructure_update:
      title: "Infrastructure Update - {{timestamp}}"
      body: |
        ## Infrastructure Changes Detected
        
        **Changes:**
        {{changes}}
        
        **Validation Status:**
        {{validation_status}}
        
        **Auto-generated by IAL System**
        
    drift_alert:
      title: "Infrastructure Drift Detected - {{resource_type}}"
      body: |
        ## Drift Alert
        
        **Resource:** {{resource_name}}
        **Type:** {{resource_type}}
        **Drift Details:** {{drift_details}}
        
        **Recommended Actions:**
        {{recommendations}}
        
        **Auto-generated by IAL Drift Detection**
        
    deployment_status:
      body: |
        ## Deployment Status Update
        
        **Status:** {{status}}
        **Timestamp:** {{timestamp}}
        **Details:** {{details}}

# Security settings
security:
  token_validation: true
  rate_limiting: true
  allowed_operations:
    - read
    - write
    - admin  # Only for specific repositories
    
# Monitoring
monitoring:
  enabled: true
  metrics:
    - api_calls_total
    - api_errors_total
    - response_time
    - rate_limit_remaining
    
  alerts:
    - condition: "rate_limit_remaining < 100"
      action: "throttle_requests"
      
    - condition: "api_errors_total > 10"
      action: "notify_admin"
