# Configura√ß√£o de Pol√≠ticas de Valida√ß√£o de Inten√ß√£o
# IAL v3.1 - Sistema de Valida√ß√£o Integrado

version: "1.0"
updated: "2025-11-04"

# Configura√ß√µes globais
global_settings:
  # Fase 2: Avisos habilitados por padr√£o
  warnings_enabled: true
  
  # Fase 3: Enforcement desabilitado por padr√£o (opt-in)
  enforcement_enabled: false
  
  # Configura√ß√µes de performance
  max_processing_time_seconds: 5.0
  cache_validation_results: true
  cache_ttl_minutes: 5

# Pol√≠ticas de valida√ß√£o
policies:
  production_resources:
    description: "Detecta recursos de produ√ß√£o"
    risk_threshold: "HIGH"
    triggers:
      patterns: ["production", "prod", "live"]
      services: ["rds", "dynamodb", "ecs"]
    warnings:
      enabled: true
      message: "‚ö†Ô∏è Recursos de produ√ß√£o detectados. Certifique-se de seguir pr√°ticas de seguran√ßa."
    enforcement:
      enabled: false  # Fase 3 - opt-in
      message: "üö´ Cria√ß√£o de recursos de produ√ß√£o requer aprova√ß√£o."
    recommendations:
      - "Revisar pol√≠ticas de seguran√ßa antes de prosseguir"
      - "Considerar executar em ambiente de teste primeiro"

  destructive_operations:
    description: "Detecta opera√ß√µes destrutivas"
    risk_threshold: "CRITICAL"
    triggers:
      operations: ["delete", "destroy", "terminate", "remove"]
      patterns: ["production", "prod"]
    warnings:
      enabled: true
      message: "üö® Opera√ß√£o destrutiva detectada. Esta a√ß√£o pode causar perda de dados."
    enforcement:
      enabled: false  # Pode ser habilitado para CRITICAL
      message: "üö´ Opera√ß√µes destrutivas em produ√ß√£o s√£o bloqueadas."
    recommendations:
      - "Fazer backup antes de opera√ß√µes destrutivas"
      - "Confirmar com equipe antes de prosseguir"

  security_services:
    description: "Detecta modifica√ß√µes de seguran√ßa"
    risk_threshold: "CRITICAL"
    triggers:
      services: ["iam", "kms", "secrets"]
      operations: ["create", "update", "delete"]
    warnings:
      enabled: true
      message: "üîê Modifica√ß√µes de seguran√ßa detectadas. Revisar pol√≠ticas de acesso."
    enforcement:
      enabled: false  # Fase 3 - opt-in
      message: "üö´ Modifica√ß√µes de seguran√ßa requerem aprova√ß√£o de administrador."
    recommendations:
      - "Revisar princ√≠pio de menor privil√©gio"
      - "Documentar mudan√ßas para auditoria"

  high_cost_services:
    description: "Detecta servi√ßos de alto custo"
    risk_threshold: "MEDIUM"
    triggers:
      services: ["rds", "redshift", "sagemaker", "eks"]
      operations: ["create", "scale"]
    warnings:
      enabled: true
      message: "üí∞ Servi√ßos de alto custo detectados. Revisar or√ßamento."
    enforcement:
      enabled: false
      message: "üö´ Cria√ß√£o de recursos de alto custo requer aprova√ß√£o financeira."
    recommendations:
      - "Verificar limites de or√ßamento"
      - "Considerar alternativas mais econ√¥micas"

# Configura√ß√µes por ambiente
environments:
  development:
    enforcement_enabled: false
    warning_threshold: "MEDIUM"
    
  staging:
    enforcement_enabled: false
    warning_threshold: "HIGH"
    
  production:
    enforcement_enabled: true  # Pode ser habilitado em prod
    warning_threshold: "LOW"
    block_destructive_operations: true

# Configura√ß√µes por usu√°rio/role
user_overrides:
  admin_users:
    - "admin"
    - "devops-lead"
    bypass_enforcement: true
    
  restricted_users:
    - "intern"
    - "contractor"
    additional_warnings: true
    lower_risk_threshold: "LOW"

# M√©tricas e auditoria
metrics:
  enabled: true
  track_validation_decisions: true
  track_blocked_operations: true
  track_warning_acknowledgments: true
  
audit:
  log_all_validations: true
  log_policy_changes: true
  retention_days: 90

# Integra√ß√£o com sistemas externos
integrations:
  slack:
    enabled: false
    webhook_url: ""
    notify_on_blocks: true
    
  email:
    enabled: false
    smtp_server: ""
    notify_admins: true
    
  jira:
    enabled: false
    create_tickets_for_blocks: false
