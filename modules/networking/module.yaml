module:
  name: "networking"
  version: "1.0.0"
  description: "Network infrastructure - VPC, subnets, flow logs"
  author: "IaL Framework"
  
metadata:
  category: "networking"
  maturity: "stable"
  dependencies: ["foundation", "security"]
  parallel_safe: false
  estimated_duration: "20min"
  team_owner: "network-team"
  risk_level: "medium"

interface:
  inputs:
    required:
      - project_name: 
          type: "string"
          description: "Project name for resource naming"
      - vpc_cidr:
          type: "string"
          default: "10.0.0.0/16"
          description: "VPC CIDR block"
    optional:
      - enable_flow_logs:
          type: "boolean"
          default: true
          description: "Enable VPC Flow Logs"
      - availability_zones:
          type: "integer"
          default: 2
          description: "Number of availability zones"

  outputs:
    - vpc_id:
        description: "VPC ID created"
        export_name: "${project_name}-vpc-id"
    - subnet_ids:
        description: "Subnet IDs created"
        export_name: "${project_name}-subnet-ids"
    - security_group_id:
        description: "Default security group ID"
        export_name: "${project_name}-default-sg"

phases:
  - name: "networking"
    file: "phases/01-networking.yaml"
    description: "VPC and networking setup"
    dependencies: []
  - name: "vpc-flow-logs"
    file: "phases/02-vpc-flow-logs.yaml"
    description: "VPC Flow Logs configuration"
    dependencies: ["networking"]

validation:
  pre_deploy:
    - check: "aws ec2 describe-vpcs --max-items 1"
      description: "Verify EC2 access"
  post_deploy:
    - check: "aws ec2 describe-vpcs --vpc-ids ${vpc_id}"
      description: "Verify VPC creation"

rollback:
  strategy: "reverse_order"
  phases:
    - "vpc-flow-logs"
    - "networking"
